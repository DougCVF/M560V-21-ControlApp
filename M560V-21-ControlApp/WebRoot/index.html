<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Part Management</title>
    <style>
        body {
            background-color: #222;
            color: #eee;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .left-panel {
            flex: 1;
            border-right: 2px solid #333;
            padding: 10px;
            overflow-y: auto;
        }

        .right-panel {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
        }

        h2 {
            margin-top: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: #111;
        }

        th, td {
            border: 1px solid #333;
            padding: 6px 8px;
            text-align: left;
        }

        th {
            background-color: #333;
        }

        tr:hover {
            background-color: #444;
            cursor: pointer;
        }

        tr.selected {
            background-color: #555;
        }

        .btn-row {
            margin-top: 10px;
            text-align: right;
        }

        button {
            background-color: #555;
            color: white;
            border: none;
            padding: 6px 12px;
            margin-left: 6px;
            cursor: pointer;
            border-radius: 4px;
        }

            button:hover {
                background-color: #777;
            }

        .field {
            margin-bottom: 6px;
        }

        .label {
            font-weight: bold;
            color: #ccc;
        }

        .value {
            color: #eee;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <h2>Part Database</h2>
            <table id="partsTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Part Number</th>
                        <th>Description</th>
                        <th>Width</th>
                        <th>Depth</th>
                        <th>Height</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="btn-row">
                <button onclick="addPart()">Add</button>
                <button onclick="editPart()">Edit</button>
                <button onclick="deletePart()">Delete</button>
                <button onclick="loadParts()">Refresh</button>
            </div>
        </div>

        <div class="right-panel" id="detailsPanel">
            <h2>Part Details</h2>
            <div id="detailsContainer">
                <div class="field"><span class="label">Part Number:</span> <span class="value" id="PartNumber"></span></div>
                <div class="field"><span class="label">Description:</span> <span class="value" id="Description"></span></div>
                <div class="field"><span class="label">Stock Width:</span> <span class="value" id="StockWidth"></span></div>
                <div class="field"><span class="label">Stock Depth:</span> <span class="value" id="StockDepth"></span></div>
                <div class="field"><span class="label">Stock Height:</span> <span class="value" id="StockHeight"></span></div>

                <div class="field"><span class="label">Op10 Pick X Offset:</span> <span class="value" id="Op10PickXOffset"></span></div>
                <div class="field"><span class="label">Op10 Pick Y Offset:</span> <span class="value" id="Op10PickYOffset"></span></div>
                <div class="field"><span class="label">Op10 Pick Z Offset:</span> <span class="value" id="Op10PickZOffset"></span></div>

                <div class="field"><span class="label">Op20 Pick X Offset:</span> <span class="value" id="Op20PickXOffset"></span></div>
                <div class="field"><span class="label">Op20 Pick Y Offset:</span> <span class="value" id="Op20PickYOffset"></span></div>
                <div class="field"><span class="label">Op20 Pick Z Offset:</span> <span class="value" id="Op20PickZOffset"></span></div>

                <div class="field"><span class="label">Op20 Fin X Offset:</span> <span class="value" id="Op20FinXOffset"></span></div>
                <div class="field"><span class="label">Op20 Fin Y Offset:</span> <span class="value" id="Op20FinYOffset"></span></div>
                <div class="field"><span class="label">Op20 Fin Z Offset:</span> <span class="value" id="Op20FinZOffset"></span></div>

                <div class="field"><span class="label">Op10 Vise PSI:</span> <span class="value" id="Op10VisePSI"></span></div>
                <div class="field"><span class="label">Op20 Vise PSI:</span> <span class="value" id="Op20VisePSI"></span></div>

                <div class="field"><span class="label">Op10 Program Name:</span> <span class="value" id="Op10ProgramName"></span></div>
                <div class="field"><span class="label">Op20 Program Name:</span> <span class="value" id="Op20ProgramName"></span></div>

                <div class="field"><span class="label">Op10 Cycle Time:</span> <span class="value" id="Op10CycleTime"></span></div>
                <div class="field"><span class="label">Op20 Cycle Time:</span> <span class="value" id="Op20CycleTime"></span></div>
            </div>
        </div>

    </div>

    <script>
        let selectedPart = null;

        async function loadParts() {
            const resp = await fetch('/api/parts', { credentials: 'include' });
            if (!resp.ok) {
                alert('Failed to load parts');
                return;
            }
            const parts = await resp.json();
            const tbody = document.querySelector('#partsTable tbody');
            tbody.innerHTML = '';

            for (const p of parts) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${p.Id}</td>
                    <td>${p.PartNumber}</td>
                    <td>${p.Description}</td>
                    <td>${p.StockWidth}</td>
                    <td>${p.StockDepth}</td>
                    <td>${p.StockHeight}</td>
                `;
                row.onclick = () => selectPart(row, p);
                tbody.appendChild(row);
            }
        }

        function selectPart(row, part) {
            document.querySelectorAll('#partsTable tr').forEach(r => r.classList.remove('selected'));
            row.classList.add('selected');
            selectedPart = part;
            updateDetails(part);
        }

        function updateDetails(p) {
            document.getElementById('PartNumber').textContent = p.PartNumber ?? '';
            document.getElementById('Description').textContent = p.Description ?? '';
            document.getElementById('StockWidth').textContent = p.StockWidth ?? '';
            document.getElementById('StockDepth').textContent = p.StockDepth ?? '';
            document.getElementById('StockHeight').textContent = p.StockHeight ?? '';

            // Op10 Pick Offsets
            document.getElementById('Op10PickXOffset').textContent = p.Op10PickXOffset ?? '';
            document.getElementById('Op10PickYOffset').textContent = p.Op10PickYOffset ?? '';
            document.getElementById('Op10PickZOffset').textContent = p.Op10PickZOffset ?? '';

            // Op20 Pick Offsets
            document.getElementById('Op20PickXOffset').textContent = p.Op20PickXOffset ?? '';
            document.getElementById('Op20PickYOffset').textContent = p.Op20PickYOffset ?? '';
            document.getElementById('Op20PickZOffset').textContent = p.Op20PickZOffset ?? '';

            // Op20 Fin Offsets
            document.getElementById('Op20FinXOffset').textContent = p.Op20FinXOffset ?? '';
            document.getElementById('Op20FinYOffset').textContent = p.Op20FinYOffset ?? '';
            document.getElementById('Op20FinZOffset').textContent = p.Op20FinZOffset ?? '';

            // Vise PSI
            document.getElementById('Op10VisePSI').textContent = p.Op10VisePSI ?? '';
            document.getElementById('Op20VisePSI').textContent = p.Op20VisePSI ?? '';

            // Program Names
            document.getElementById('Op10ProgramName').textContent = p.Op10ProgramName ?? '';
            document.getElementById('Op20ProgramName').textContent = p.Op20ProgramName ?? '';

            // Cycle Times
            document.getElementById('Op10CycleTime').textContent = p.Op10CycleTime ?? '';
            document.getElementById('Op20CycleTime').textContent = p.Op20CycleTime ?? '';
        }


        function addPart() {
            alert('Add Part (coming soon)');
        }

        function editPart() {
            if (!selectedPart) {
                alert('Select a part to edit');
                return;
            }
            alert('Edit Part (coming soon)');
        }

        function deletePart() {
            if (!selectedPart) {
                alert('Select a part to delete');
                return;
            }
            alert('Delete Part (coming soon)');
        }

        loadParts();
    </script>
</body>
</html>
