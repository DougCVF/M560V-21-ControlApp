<UserControl x:Class="M560V_21_ControlApp.Controls.PartManagementControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Background="#202020">

    <!-- ========== RESOURCES ========== -->
    <UserControl.Resources>
        <!-- Dark header style -->
        <Style x:Key="DarkHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#2D2D30"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderBrush" Value="#3A3A3A"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <!-- Dark row style -->
        <Style x:Key="DarkRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="Foreground" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="#333"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2C4F7C"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#3A6EA5"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <!-- ========== LAYOUT ========== -->
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Part Database Management"
                   FontSize="18"
                   FontWeight="Bold"
                   Foreground="#F0F0F0"
                   Margin="0,0,0,10"/>

        <!-- Content area -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="420"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT: Parts grid -->
            <DataGrid x:Name="dgParts"
                      Grid.Column="0"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      IsReadOnly="True"
                      SelectionMode="Single"
                      GridLinesVisibility="None"
                      Background="#1E1E1E"
                      Foreground="#F0F0F0"
                      AlternatingRowBackground="#252526"
                      RowBackground="#1E1E1E"
                      BorderBrush="#444"
                      BorderThickness="1"
                      ColumnHeaderStyle="{StaticResource DarkHeaderStyle}"
                      RowStyle="{StaticResource DarkRowStyle}"
                      HeadersVisibility="Column">

                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="48"/>
                    <DataGridTextColumn Header="Part Number" Binding="{Binding PartNumber}" Width="120"/>
                    <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="180"/>
                    <DataGridTextColumn Header="Width" Binding="{Binding StockWidth}" Width="70"/>
                    <DataGridTextColumn Header="Depth" Binding="{Binding StockDepth}" Width="70"/>
                    <DataGridTextColumn Header="Height" Binding="{Binding StockHeight}" Width="70"/>
                    <DataGridTextColumn Header="Op10 Time" Binding="{Binding Op10CycleTime}" Width="80"/>
                    <DataGridTextColumn Header="Op20 Time" Binding="{Binding Op20CycleTime}" Width="80"/>
                    <DataGridTextColumn Header="Op10 Prog" Binding="{Binding Op10ProgramName}" Width="120"/>
                    <DataGridTextColumn Header="Op20 Prog" Binding="{Binding Op20ProgramName}" Width="120"/>
                    <DataGridTextColumn Header="Op10 PSI" Binding="{Binding Op10VisePSI}" Width="70"/>
                    <DataGridTextColumn Header="Op20 PSI" Binding="{Binding Op20VisePSI}" Width="70"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- RIGHT: Details -->
            <Border Grid.Column="1"
                    Margin="10,0,0,0"
                    Background="#161616"
                    BorderBrush="#3A3A3A"
                    BorderThickness="1"
                    CornerRadius="6">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12">
                        <!-- Styles MUST be first child -->
                        <StackPanel.Resources>
                            <Style TargetType="TextBlock" x:Key="LabelStyle">
                                <Setter Property="Foreground" Value="#C8C8C8"/>
                                <Setter Property="Margin" Value="0,6,0,0"/>
                            </Style>
                            <Style TargetType="TextBlock" x:Key="ValueStyle">
                                <Setter Property="Foreground" Value="#F0F0F0"/>
                            </Style>
                        </StackPanel.Resources>

                        <TextBlock Text="Part Details"
                                   FontWeight="Bold"
                                   Foreground="#F0F0F0"
                                   FontSize="14"
                                   Margin="0,0,0,8"/>

                        <!-- Identity -->
                        <TextBlock Text="Part Number" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.PartNumber, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Description" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Description, ElementName=dgParts}" Style="{StaticResource ValueStyle}" TextWrapping="Wrap"/>

                        <!-- Stock -->
                        <TextBlock Text="Stock Width" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.StockWidth, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Stock Depth" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.StockDepth, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Stock Height" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.StockHeight, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <!-- Op10 -->
                        <TextBlock Text="Op10 Pick X Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10PickXOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op10 Pick Y Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10PickYOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op10 Pick Z Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10PickZOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <!-- Op20 -->
                        <TextBlock Text="Op20 Pick X Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20PickXOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Pick Y Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20PickYOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Pick Z Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20PickZOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <!-- Finish -->
                        <TextBlock Text="Op20 Fin X Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20FinXOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Fin Y Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20FinYOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Fin Z Offset" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20FinZOffset, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <!-- PSI & Programs -->
                        <TextBlock Text="Op10 Vise PSI" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10VisePSI, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Vise PSI" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20VisePSI, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op10 Program Name" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10ProgramName, ElementName=dgParts}" Style="{StaticResource ValueStyle}" TextWrapping="Wrap"/>

                        <TextBlock Text="Op20 Program Name" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20ProgramName, ElementName=dgParts}" Style="{StaticResource ValueStyle}" TextWrapping="Wrap"/>

                        <!-- Times -->
                        <TextBlock Text="Op10 Cycle Time (min)" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op10CycleTime, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />

                        <TextBlock Text="Op20 Cycle Time (min)" Style="{StaticResource LabelStyle}" />
                        <TextBlock Text="{Binding SelectedItem.Op20CycleTime, ElementName=dgParts}" Style="{StaticResource ValueStyle}" />
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Footer buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Add" Width="80" Margin="5" Click="Add_Click"/>
            <Button Content="Edit" Width="80" Margin="5" Click="Edit_Click"/>
            <Button Content="Delete" Width="80" Margin="5" Click="Delete_Click"/>
            <Button Content="Refresh" Width="80" Margin="5" Click="Refresh_Click"/>
        </StackPanel>
    </Grid>
</UserControl>
